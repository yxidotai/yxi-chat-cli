Metadata-Version: 2.4
Name: yxi-chat-cli
Version: 0.1.0
Summary: Lightweight terminal chat CLI with MCP integration
Requires-Python: >=3.11
Description-Content-Type: text/markdown
Requires-Dist: fastapi>=0.111.0
Requires-Dist: requests>=2.32.5
Requires-Dist: rich>=14.2.0
Requires-Dist: python-docx>=1.1.0
Requires-Dist: uvicorn>=0.30.0
Requires-Dist: langgraph>=0.2.27

# yxi-chat-cli â€” è½»é‡çº§å¼€å‘è‡ªåŠ¨åŒ–åŠ©æ‰‹

åŸºäºè‡ªç„¶è¯­è¨€äº¤äº’çš„è½»é‡çº§å¼€å‘å·¥å…·ã€‚é€šè¿‡ `yxi-chat-cli` æ¥æ”¶æŒ‡ä»¤ï¼Œä½¿ç”¨ MCPï¼ˆMaster Control Programï¼‰è°ƒåº¦ä»»åŠ¡ï¼Œå¹¶å¯é…åˆ Docker Slim å¯¹æ‰§è¡Œå®¹å™¨è¿›è¡Œä½“ç§¯ä¸å¯åŠ¨æ—¶é—´ä¼˜åŒ–ã€‚

## âœ¨ é¡¹ç›®äº®ç‚¹

- **è‡ªç„¶è¯­è¨€äº¤äº’**ï¼šä½¿ç”¨æ—¥å¸¸è¯­è¨€è§¦å‘å¼€å‘ä»»åŠ¡ï¼Œé™ä½å­¦ä¹ æˆæœ¬ã€‚
- **è½»é‡éš”ç¦»æ‰§è¡Œ**ï¼šç»“åˆ Docker ä¸ Docker Slimï¼Œå¯æ˜¾è‘—å‡å°é•œåƒä½“ç§¯å¹¶åŠ å¿«å¯åŠ¨é€Ÿåº¦ï¼Œä¿è¯ç¯å¢ƒéš”ç¦»ã€‚
- **çµæ´»çš„ MCP è°ƒåº¦**ï¼šæ”¯æŒåŠ¨æ€æ·»åŠ /åˆ‡æ¢ MCP èŠ‚ç‚¹ï¼Œä¾¿äºé›†ä¸­ç®¡ç†å¤šç¯å¢ƒä¸å¤šä»»åŠ¡ã€‚
- **å¼€ç®±å³ç”¨çš„ä»£ç ç”Ÿæˆ**ï¼šå†…ç½®è¾…åŠ©å‡½æ•°ï¼Œå¯æŒ‰éœ€æ‹“å±•åˆ°å…¶ä»–è¯­è¨€æˆ–ä»£ç éª¨æ¶ã€‚
- **æ¨¡å—åŒ–ä¸å¯æ‰©å±•**ï¼šè®¾è®¡ä¸Šä¾¿äºæ‰©å±•æ–°ä»»åŠ¡ï¼ˆä¾‹å¦‚æ•°æ®å¤„ç†ã€è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬ç”Ÿæˆç­‰ï¼‰ã€‚
- **LangGraph æ™ºèƒ½ä½“**ï¼šå†…ç½® doc2java agentï¼Œè‡ªåŠ¨ä¸²è” Word è¡¨æ ¼æå–ä¸ JSONâ†’Java ç”Ÿæˆï¼Œå¯é€šè¿‡ `/agent doc2java ...` ä¸€é”®è°ƒç”¨ã€‚

## ğŸš€ å¿«é€Ÿä¸Šæ‰‹

ä¸‹é¢çš„æ­¥éª¤è¦†ç›– macOSã€Linux å¸¸è§åœºæ™¯ï¼›è¯·æ ¹æ®ä½ çš„ç³»ç»Ÿé€‰æ‹©åˆé€‚çš„å‘½ä»¤ã€‚

### 1. ç¯å¢ƒå‡†å¤‡

- å®‰è£… Dockerï¼šå‚è§ https://docs.docker.com/get-docker/ ã€‚
- å¯é€‰ï¼šå®‰è£… Docker Slimï¼ˆç”¨äºä¼˜åŒ–é•œåƒä½“ç§¯ï¼‰ï¼š
  - å®˜æ–¹ä»“åº“ï¼šhttps://github.com/docker-slim/docker-slim
  - ç¤ºä¾‹å®‰è£…å‘½ä»¤ï¼ˆLinux/macOSï¼‰ï¼š
    ```bash
    curl -sL https://raw.githubusercontent.com/docker-slim/docker-slim/master/scripts/install-dockerslim.sh | sudo -E bash -
    ```
- å®‰è£… Pythonï¼ˆå»ºè®® 3.7+ï¼‰ï¼šmacOS å¯ç”¨ `brew install python`ï¼ŒLinux å¯ç”¨å¯¹åº”åŒ…ç®¡ç†å™¨ï¼ˆå¦‚ `apt` / `yum`ï¼‰ã€‚

### 2. å…‹éš†é¡¹ç›®å¹¶å®‰è£…ä¾èµ–

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/yxidotai/yxi-chat-cli.git
cd yxi-chat-cli

# æ¨èï¼šä½¿ç”¨ uv ç®¡ç†ä¾èµ–
curl -LsSf https://astral.sh/uv/install.sh | sh
uv sync  # æ ¹æ® pyproject.toml å®‰è£… requestsã€rich ç­‰ä¾èµ–

# å¦‚éœ€ä¸´æ—¶æ‰©å±•ä¾èµ–ï¼Œå¯æ‰§è¡Œï¼ˆç¤ºä¾‹ï¼‰
uv add httpx

# å¦‚æœæš‚ä¸ä½¿ç”¨ uvï¼Œå¯ fallback åˆ° pip
pip install -r requirements.txt
```

ï¼ˆå¦‚æœä»£ç ä¸­å­˜åœ¨å­æ¨¡å—æˆ–å•ç‹¬çš„ `mcp/requirements.txt`ï¼Œè¯·åœ¨ `mcp` ç›®å½•å†…è¿è¡Œ `pip install -r requirements.txt`ã€‚ï¼‰

### 3. æ„å»ºå¹¶ä¼˜åŒ–ä»£ç ç”Ÿæˆå®¹å™¨ï¼ˆå¯é€‰ï¼‰

```bash
# è¿›å…¥ä»£ç ç”ŸæˆæœåŠ¡ç›®å½•ï¼ˆç¤ºä¾‹ï¼‰
cd app

# æ„å»ºåŸå§‹é•œåƒ
docker build -t codegen-executor .

# ä½¿ç”¨ Docker Slim ä¼˜åŒ–é•œåƒï¼ˆå¯é€‰ï¼‰
docker-slim build --optimize --tag codegen-executor:slim codegen-executor

cd ..
```

### 4. å¯åŠ¨æœåŠ¡

1. å¯åŠ¨ MCP æœåŠ¡å™¨ï¼ˆåœ¨ `mcp` ç›®å½•ï¼‰ï¼š

```bash
cd mcp
uv run python mcp.py   # é»˜è®¤ç›‘å¬ http://localhost:8000ï¼ˆå¦‚éœ€ä¿®æ”¹è¯·æŸ¥çœ‹ mcp é…ç½®ï¼‰
```

2. å¯åŠ¨ç»ˆç«¯ Chatbotï¼ˆåœ¨é¡¹ç›®æ ¹ç›®å½•ï¼Œæ–°ç»ˆç«¯ï¼‰ï¼š

```bash
uv run python chatbot.py
```

è¿è¡Œå‰å¯è®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
- `YXI_API_KEY`ï¼šäº‘ç«¯å¯¹è¯æ‰€éœ€ API å¯†é’¥ã€‚
- `YXI_API_BASE_URL`ï¼šè‡ªå®šä¹‰ yxi API åŸºç¡€ URLï¼ˆé»˜è®¤ `https://api.yxi.ai/v1`ï¼‰ã€‚
- `YXI_MODEL`ï¼šæŒ‡å®šè°ƒç”¨çš„äº‘ç«¯æ¨¡å‹ï¼ˆé»˜è®¤ `yxi-7b-terminal`ï¼‰ã€‚

è‹¥ä¸ä¾¿è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œä¹Ÿå¯ä»¥åœ¨ CLI ä¸­æ‰§è¡Œ `/apikey set <å€¼>` ä¸´æ—¶é…ç½®ï¼›è¯¥å€¼ä¼šä»¥æ˜æ–‡å†™å…¥ `~/.yxi_chat_config.json`ï¼Œè¯·æŒ‰éœ€è¯„ä¼°å®‰å…¨é£é™©ã€‚

### 5. ä½¿ç”¨ç¤ºä¾‹

åœ¨ Chatbot ç»ˆç«¯è¾“å…¥è‡ªç„¶è¯­è¨€æˆ–å‘½ä»¤ï¼Œç¤ºä¾‹ï¼š

```bash
# æ·»åŠ  MCP æœåŠ¡å™¨
/mcp add LocalMCP http://localhost:8000

# åˆ‡æ¢åˆ°ç¦»çº¿æ¨¡å¼å¹¶ç»‘å®šèŠ‚ç‚¹
/mode offline LocalMCP

# åˆ—å‡ºç°æœ‰ MCP
/mcp list

# æŸ¥çœ‹æŒ‡ä»¤å¸®åŠ©
/help

# å°†æœ€è¿‘åŠ©ç†å›å¤ä¸­çš„ä»£ç å—å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ˆmacOSï¼‰
/copy  # æˆ– /c

# äº¤äº’å¼è®¾ç½® API Key
/apikey set sk-your-key

# æŸ¥çœ‹å¯ç”¨æ¨¡å‹å¹¶åˆ‡æ¢
/model list
/model use yxi-7b-terminal
/model default yxi-7b-terminal

# å°† JSON è½¬æˆ C++ ç±»ï¼ˆå›åˆ°åœ¨çº¿æ¨¡å¼ï¼‰
/mode online
å°† {"name":"Alice","age":30,"address":{"city":"NY"}} è½¬æˆ class Person

# ç¦»çº¿æ¨¡å¼ç›´æ¥è°ƒç”¨å·¥å…·ï¼ˆnode å¯çœç•¥ä¸ºé»˜è®¤ç¦»çº¿èŠ‚ç‚¹ï¼‰
word_tables_to_json {"doc_path":"/data/demo.docx"}

# è°ƒç”¨ MCP å·¥å…·
/mcp invoke json_to_cpp {"schema":{"name":"Demo"}}

# è¿è¡Œ Obsidian MCPï¼ˆç¤ºä¾‹ï¼‰å¹¶æ³¨å†Œ
OBSIDIAN_VAULT_DIR=~/Documents/ObsidianVault OBSIDIAN_MCP_TOKEN=sk-obsidian uv run python tasks/obsidian_mcp/mcp_service.py
/mcp add obsidian http://localhost:8025 sk-obsidian
/mcp tools obsidian
/mcp invoke search_notes {"query":"roadmap","limit":5}
/mcp invoke append_note {"path":"notes/todo.md","content":"- [ ] new item"}

# å°†åµŒå¥— JSON è½¬æˆ Java ç±»ï¼ˆå¯æŒ‡å®šåŒ…åï¼‰
uv run python tasks/json_to_java/generate_java.py samples/nested.json -o Output.java --package com.example.demo --class-name Root

# Docker æ–¹å¼è¿è¡Œ Obsidian MCPï¼ˆç¤ºä¾‹ï¼‰
docker build -f tasks/obsidian_mcp/Dockerfile -t yxi-obsidian-mcp .
docker run --rm -p 8025:8025 \
  -v "$HOME/Documents/ObsidianVault:/vault" \
  -e OBSIDIAN_VAULT_DIR=/vault \
  -e OBSIDIAN_MCP_TOKEN=sk-obsidian \
  yxi-obsidian-mcp
```

## ğŸ“‹ æ ¸å¿ƒåŠŸèƒ½

**å¸¸ç”¨æŒ‡ä»¤**
- `/help`ï¼šæŸ¥çœ‹å¯ç”¨å‘½ä»¤ä¸æ¨¡å¼æç¤ºã€‚
# yxi-chat-cli Â· è½»é‡çº§å¼€å‘è‡ªåŠ¨åŒ–ä¸ç¦»çº¿å·¥å…·é“¾

yxi-chat-cli æ˜¯ä¸€ä¸ªä»¥è‡ªç„¶è¯­è¨€é©±åŠ¨çš„ç»ˆç«¯åŠ©æ‰‹ï¼Œå†…ç½®å¤šç§ MCPï¼ˆMaster Control Programï¼‰å·¥å…·ï¼Œå¹¶æä¾› Docker åŒ–çš„æœ¬åœ°è¿è¡Œæ–¹æ¡ˆï¼Œå¯åœ¨å®Œå…¨ç¦»çº¿çš„ç¯å¢ƒä¸‹å®Œæˆæ–‡æ¡£è§£æä¸ä»£ç ç”Ÿæˆã€‚

## åŠŸèƒ½é€Ÿè§ˆ

- å¯¹è¯å¼ CLIï¼šç”¨å£è¯­åŒ–æŒ‡ä»¤è°ƒç”¨å·¥å…·æˆ–å‘èµ·ç”Ÿæˆä»»åŠ¡ã€‚
- MCP å·¥å…·é›†ï¼š
  - `word_tables_to_json` å°† Word è¡¨æ ¼æŠ½å–ä¸º JSONã€‚
  - `json_to_java` å°† JSON ç»“æ„ç”Ÿæˆå•æ–‡ä»¶ Java POJOã€‚
- LangGraph æ™ºèƒ½ä½“ï¼š`doc2java` ä¸²è” Word è¡¨æ ¼æå–ä¸ Java ç”Ÿæˆã€‚
- Docker æ”¯æŒï¼šä¸¤é¡¹æœåŠ¡å‡æä¾›é•œåƒï¼Œä¾¿äºéš”ç¦»éƒ¨ç½²ä¸æŒ‚è½½æ•°æ®å·ã€‚

## ç¯å¢ƒè¦æ±‚

- Python 3.11+
- Dockerï¼ˆå¯é€‰ï¼Œç”¨äºè¿è¡ŒæœåŠ¡é•œåƒï¼‰
- æ¨èä½¿ç”¨ uv ç®¡ç†ä¾èµ–

## å®‰è£…

```bash
git clone https://github.com/yxidotai/yxi-chat-cli.git
cd yxi-chat-cli
curl -LsSf https://astral.sh/uv/install.sh | sh
uv sync
```

å¦‚éœ€ pipï¼š`pip install -r requirements.txt`

## å¯åŠ¨ CLIï¼ˆæœ¬æœºï¼‰

```bash
uv run python chatbot.py
```

å¸¸ç”¨æŒ‡ä»¤ï¼š

- `/help` æŸ¥çœ‹å¸®åŠ©
- `/copy` å¤åˆ¶æœ€è¿‘å›å¤ä»£ç å—
- `/apikey set <value>` è®¾ç½®äº‘ç«¯ API Keyï¼ˆè‹¥éœ€åœ¨çº¿æ¨¡å‹ï¼‰
- `/mode offline <node>` åˆ‡æ¢ç¦»çº¿å¹¶æŒ‡å®š MCP èŠ‚ç‚¹
- `/mcp add <name> <url> [token]` æ³¨å†Œ MCP æœåŠ¡
- `/agent doc2java ...` è¿è¡Œæ–‡æ¡£â†’Java æ™ºèƒ½ä½“

## æœ¬åœ°è¿è¡Œ MCP æœåŠ¡ï¼ˆæ— éœ€ Dockerï¼‰

- Word è¡¨æ ¼ï¼š`uv run python tasks/word_table_export/mcp_service.py` ï¼ˆé»˜è®¤ 0.0.0.0:8000ï¼Œ`WORD_MCP_HOST/PORT` å¯è¦†ç›–ï¼‰
- JSONâ†’Javaï¼š`uv run python tasks/json_to_java/mcp_service.py` ï¼ˆé»˜è®¤ 0.0.0.0:8030ï¼Œ`JSON_TO_JAVA_HOST/PORT` å¯è¦†ç›–ï¼‰

å¥åº·æ£€æŸ¥ï¼š`curl http://localhost:8000/healthz`ã€`curl http://localhost:8030/healthz`

## Docker æ„å»ºä¸è¿è¡Œ

ä»ä»“åº“æ ¹ç›®å½•æ‰§è¡Œï¼š

```bash
# æ„å»ºé•œåƒ
docker build -f tasks/word_table_export/Dockerfile -t yxi-word-mcp .
docker build -f tasks/json_to_java/Dockerfile -t yxi-json-to-java .

# è¿è¡Œ Word è¡¨æ ¼æœåŠ¡ï¼ˆæŒ‚è½½æ ·ä¾‹æ–‡æ¡£ï¼‰
docker run --rm -p 8000:8000 -v "$PWD/samples:/data" yxi-word-mcp

# è¿è¡Œ JSONâ†’Java æœåŠ¡ï¼ˆå¯æŒ‚è½½è¾“å‡ºç›®å½•ï¼‰
mkdir -p output
docker run --rm -p 8030:8030 -v "$PWD/output:/out" yxi-json-to-java
```

è¯´æ˜ï¼š

- æœåŠ¡å†…éƒ¨ç«¯å£å›ºå®šä¸º 8000ï¼ˆwordï¼‰å’Œ 8030ï¼ˆjavaï¼‰ã€‚ä¿®æ”¹æ˜ å°„è¯·åŒæ­¥è°ƒæ•´ CLI çš„ `--word-url` / `--java-url`ã€‚
- ä¼ å…¥çš„æ–‡ä»¶è·¯å¾„å¿…é¡»æ˜¯å®¹å™¨å¯è§è·¯å¾„ã€‚ä¸Šä¾‹å°† `samples` æŒ‚è½½ä¸º `/data`ï¼Œå› æ­¤åº”ä½¿ç”¨ `/data/demo.docx`ã€‚
- `--output-path` æŒ‡å‘å®¹å™¨å†…è·¯å¾„ï¼›è‹¥éœ€è½ç›˜åˆ°å®¿ä¸»æœºï¼Œè¯·æŒ‚è½½ç›®å½•å¹¶å†™å…¥æŒ‚è½½ç‚¹ï¼ˆå¦‚ `/out/Output.java`ï¼‰ã€‚

## LangGraph æ™ºèƒ½ä½“ï¼šdocx â†’ è¡¨æ ¼ â†’ Java

å½“ä¸¤ä¸ªæœåŠ¡å·²å¯åŠ¨ï¼ˆç«¯å£åŒ¹é…ï¼‰æ—¶ï¼Œå¯åœ¨ CLI æ‰§è¡Œï¼š

```bash
/agent doc2java /data/demo.docx \
  --word-url http://localhost:8000 \
  --java-url http://localhost:8030 \
  --package com.example.demo \
  --class-name Root \
  --output-path /out/Output.java
```

è‹¥ä½¿ç”¨æœ¬æœºæ–‡ä»¶ä¸”ç›´æ¥è¿è¡Œæœ¬åœ°æœåŠ¡ï¼Œå¯å°†æ–‡æ¡£è·¯å¾„æ¢ä¸ºå®¿ä¸»æœºç»å¯¹è·¯å¾„ï¼Œè¾“å‡ºè·¯å¾„æ¢ä¸ºæœ¬æœºå¯å†™ç›®å½•ï¼ˆä¾‹å¦‚ `/tmp/Output.java`ï¼‰ã€‚

## MCP å·¥å…·æ¥å£æ‘˜è¦

- `word_tables_to_json`
  - è¾“å…¥ï¼š`doc_path`ï¼ˆå®¹å™¨å¯è§è·¯å¾„ï¼‰æˆ– `doc_base64`
  - é€‰é¡¹ï¼š`treat_first_row_as_header`ã€`keep_empty_rows`
  - ç«¯ç‚¹ï¼š`/tools/word_tables_to_json`

- `json_to_java`
  - è¾“å…¥ï¼š`json_text` æˆ– `json_path`ï¼Œå¯é€‰ `root_path`ã€`package`ã€`class_name`ã€`output_path`
  - ç«¯ç‚¹ï¼š`/tools/json_to_java`

## å¸¸è§é—®é¢˜æ’æŸ¥

- 404 æˆ–è¿æ¥å¤±è´¥ï¼šæ£€æŸ¥å®¹å™¨ç«¯å£æ˜ å°„æ˜¯å¦ä¸ `--word-url` / `--java-url` ä¸€è‡´ï¼›ç¡®ä¿å®¹å™¨åœ¨è¿è¡Œã€‚
- æ‰¾ä¸åˆ°æ–‡æ¡£ï¼šç¡®è®¤ `doc_path` æŒ‡å‘å®¹å™¨å†…å¯è§è·¯å¾„ï¼ˆå¦‚ `/data/demo.docx`ï¼‰ï¼Œå¹¶å·²é€šè¿‡ `-v` æŒ‚è½½ã€‚
- è¾“å‡ºæ–‡ä»¶ä¸¢å¤±ï¼š`--output-path` å†™åœ¨å®¹å™¨å†…ï¼Œéœ€æŒ‚è½½è¾“å‡ºç›®å½•å¹¶å†™å…¥æŒ‚è½½ç‚¹ï¼ˆå¦‚ `/out/Output.java`ï¼‰ã€‚
- Docker å‘½ä»¤æŠ¥é”™ï¼ˆåŒ `-v`ï¼‰ï¼šç¡®ä¿å·å‚æ•°æ ¼å¼ä¸º `-v host_path:container_path`ã€‚

## å…è´£å£°æ˜

- æœ¬é¡¹ç›®ä¸ºå®éªŒæ€§å·¥å…·ï¼Œé€‚ç”¨äºå­¦ä¹ ä¸å†…éƒ¨ç ”å‘ï¼Œä¸æ‰¿è¯ºç”Ÿäº§çº§ç¨³å®šæ€§æˆ–å®‰å…¨æ€§ã€‚
- ä½¿ç”¨å‰è¯·è‡ªè¡Œå®Œæˆåˆè§„ã€å®¡è®¡ä¸é£é™©è¯„ä¼°ï¼›å¯¹å› é…ç½®æˆ–ç”Ÿæˆä»£ç å¯¼è‡´çš„æŸå¤±æ¦‚ä¸è´Ÿè´£ã€‚
